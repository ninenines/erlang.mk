<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Erlang.mk User Guide</title>
<style type="text/css"><!--
body{background:white;color:black;font-family:"Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;justify-content:center;margin:0 auto;padding:0;width:600px}
header {align-items:center;display:flex;justify-content:center}
header nav.left{text-align:right;width:150px}
header nav.right{text-align:left;width:150px}
header nav a{display:block;margin:1.5em 1em}
main{margin-top:2em;text-align:justify}
main h2, main h3{margin-top:2em}
main h1, main div.chapter>div.titlepage h2{font-size:2em;margin-top:.67em}
a{color:#d9230f;text-decoration:none}
a:hover{text-decoration:underline}
a.xref{display:none}
h1, h2, h3{font-weight:normal}
div.navfooter{margin-bottom:1em}
--></style>
</head>
<body>
<header>
	<nav class="left">
		<a href="index.html">User guide</a>
		<a href="getting_started.html">Tutorials</a>
	</nav>
	<a href="/" class="logo"><img src="../res/logo-small.png" alt="Erlang.mk" title="Erlang.mk: A build tool for Erlang that just works" height="200" width="206"/></a>
	<nav class="right">
		<a href="https://github.com/ninenines/erlang.mk/tree/master/index">470+ packages</a>
		<a href="https://github.com/ninenines/erlang.mk/issues">Issues?</a>
	</nav>
</header>
<main>

<div class="navheader"><table width="100%" summary="Navigation header"><tr><td width="20%" align="left"><a accesskey="p" href="compat.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="docs.html">Next</a></td></tr></table><hr /></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="elixir"></a>Chapter 15. Elixir modules and dependencies</h2></div></div></div><p>Erlang.mk has experimental support for building Elixir
modules as well as dependencies. In this chapter we will
cover the details and gotchas of the Elixir support.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_selecting_elixir"></a>15.1. Selecting Elixir</h2></div></div></div><p>By default Elixir is disabled. This is to ensure that
there’s no negative impact to normal users of Erlang.mk.</p><p>Erlang.mk can use either an Elixir installed in the
system; or use Elixir as a dependency.</p><p>Elixir will be automatically enabled when Elixir is
used as a dependency. In that case all that is required
is to depend on Elixir:</p><pre class="programlisting">DEPS = elixir
dep_elixir_commit = v1.17.3</pre><p>Alternatively, Erlang.mk will enable the system Elixir
installation when Elixir files are found in the top-level
project. In that case, Elixir is assumed to be in the path.</p><p>In other cases, the system Elixir installation must be
enabled manually in order to depend on Elixir applications.
Note that this is only required for Elixir-only applications,
not for applications that have both Erlang and Elixir code
(as long as you only care about the Erlang side of things).
The <code class="literal">ELIXIR</code> variable must be defined before including
Erlang.mk:</p><pre class="programlisting">ELIXIR = system</pre><p>Elixir can be explicitly disabled. In that case trying to
depend on Elixir applications will result in failure
during autopatch, unless the Elixir application has both
Erlang and Elixir code.</p><pre class="programlisting">ELIXIR = disable</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_elixir_compilation"></a>15.2. Elixir compilation</h2></div></div></div><p>There are currently no options.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_elixir_dependencies"></a>15.3. Elixir dependencies</h2></div></div></div><p>Erlang.mk will automatically autopatch Elixir dependencies
by running Mix on the mix.exs file and producing a Makefile
using the generated metadata.</p><p>The following is an example of depending on Elixir
applications from an Erlang-only application:</p><pre class="programlisting">DEPS = jose
dep_jose = hex 1.11.10

ELIXIR = system

include erlang.mk</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_dialyzer"></a>15.4. Dialyzer</h2></div></div></div><p>Dialyzer requires Elixir to be available in order to access
the AST of the Elixir beam files. In most cases it will just
work. When only enabling Elixir in a sub-application, Elixir
will not always be available, so in that case we must tell
Dialyzer where to find Elixir libraries. This can be done
by adding the following rules to the relevant Makefiles,
either as a plugin or after including Erlang.mk:</p><pre class="programlisting">dialyze: ELIXIR_LIBS = $(dir $(shell readlink -f `which elixir`))/../lib
dialyze: ERL_LIBS = $(APPS_DIR):$(DEPS_DIR):$(ELIXIR_LIBS)</pre></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="compat.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="code.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="docs.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top"> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> </td></tr></table></div>
</main>
</body>
</html>
