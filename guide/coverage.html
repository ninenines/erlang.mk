<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Erlang.mk User Guide</title>
<style type="text/css"><!--
body{background:white;color:black;font-family:"Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;justify-content:center;margin:0 auto;padding:0;width:600px}
header {align-items:center;display:flex;justify-content:center}
header nav.left{text-align:right;width:150px}
header nav.right{text-align:left;width:150px}
header nav a{display:block;margin:1.5em 1em}
main{margin-top:2em;text-align:justify}
main h2, main h3{margin-top:2em}
main h1, main div.chapter>div.titlepage h2{font-size:2em;margin-top:.67em}
a{color:#d9230f;text-decoration:none}
a:hover{text-decoration:underline}
a.xref{display:none}
h1, h2, h3{font-weight:normal}
div.navfooter{margin-bottom:1em}
--></style>
</head>
<body>
<header>
	<nav class="left">
		<a href="index.html">User guide</a>
		<a href="getting_started.html">Tutorials</a>
	</nav>
	<a href="/" class="logo"><img src="../res/logo-small.png" alt="Erlang.mk" title="Erlang.mk: A build tool for Erlang that just works" height="200" width="206"/></a>
	<nav class="right">
		<a href="https://github.com/ninenines/erlang.mk/tree/master/index">470+ packages</a>
		<a href="https://github.com/ninenines/erlang.mk/issues">Issues?</a>
	</nav>
</header>
<main>

<div class="navheader"><table width="100%" summary="Navigation header"><tr><td width="20%" align="left"><a accesskey="p" href="triq.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ci.html">Next</a></td></tr></table><hr /></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="coverage"></a>Chapter 23. Code coverage</h2></div></div></div><p>Erlang.mk provides support for code coverage via the tool
<code class="literal">cover</code> that comes with Erlang/OTP. Code coverage lets you
see what parts of your code are covered by the tests.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_enabling_cover_when_running_tests"></a>23.1. Enabling cover when running tests</h2></div></div></div><p>To run tests with code coverage enabled, simply define
<code class="literal">COVER=1</code> either on the command line or in your Makefile:</p><pre class="programlisting">$ make tests COVER=1</pre><p>When running the targets <code class="literal">tests</code> or <code class="literal">check</code> the code
coverage report will be built automatically. This is
not the case for test framework specific targets,
however. In those cases you can generate the reports
manually:</p><pre class="programlisting">$ make eunit proper COVER=1
$ make cover-report</pre><p>Note that Common Test has some support for <code class="literal">cover</code>
built-in and that it will generate code coverage
reports in the Common Test logs regardless. The
report that Erlang.mk generates is however common
to all test frameworks and might be more useful.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_adding_applications_to_the_cover_report"></a>23.2. Adding applications to the cover report</h2></div></div></div><p>By default Erlang.mk will include all the applications
in the code coverage report, except external dependencies.</p><p>To include some dependencies in the report, you can
define the <code class="literal">COVER_DEPS</code> variable:</p><pre class="programlisting">COVER_DEPS = cowlib</pre><p>When using multi application repositories you can exclude
some applications by defining the <code class="literal">COVER_APPS</code> variable:</p><pre class="programlisting">COVER_APPS = presence backend</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_removing_modules_from_the_cover_report"></a>23.3. Removing modules from the cover report</h2></div></div></div><p>By default Erlang.mk will include all modules in the
cover report.</p><p>To exclude some modules from the report, you can
define the <code class="literal">COVER_EXCLUDE_MODS</code> variable:</p><pre class="programlisting">COVER_EXCLUDE_MODS = cowboy_app cowboy_sup</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_configuring_paths"></a>23.4. Configuring paths</h2></div></div></div><p>By default Erlang.mk will store <span class="emphasis"><em>coverdata</em></span> files and
code coverage reports under the <span class="emphasis"><em>cover/</em></span> directory. The
variables <code class="literal">COVER_DATA_DIR</code> and <code class="literal">COVER_REPORT_DIR</code> can be
set to use a different location.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_merging_coverdata_files"></a>23.5. Merging coverdata files</h2></div></div></div><p>The target <code class="literal">all.coverdata</code> will take all existing
<span class="emphasis"><em>coverdata</em></span> files and merge them into one:</p><pre class="programlisting">$ make all.coverdata</pre></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="triq.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="tests.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ci.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top"> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> </td></tr></table></div>
</main>
</body>
</html>
